{"version":3,"sources":["webpack:///perspective.cjs.js","webpack:///webpack/bootstrap 79e024b3e3fa01d7859e","webpack:///./src/js/utils.js","webpack:///./src/js/perspective.parallel.js","webpack:///external \"babel-runtime/core-js/json/stringify\"","webpack:///external \"babel-runtime/core-js/object/get-prototype-of\"","webpack:///external \"babel-runtime/helpers/classCallCheck\"","webpack:///external \"babel-runtime/helpers/createClass\"","webpack:///external \"babel-runtime/helpers/possibleConstructorReturn\"","webpack:///external \"babel-runtime/helpers/inherits\"","webpack:///external \"babel-runtime/core-js/get-iterator\"","webpack:///external \"babel-runtime/core-js/object/get-own-property-names\"","webpack:///./src/js/defaults.js","webpack:///./src/js/api.js","webpack:///external \"babel-runtime/core-js/promise\""],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","bindall","self","_iterator","_getOwnPropertyNames2","constructor","_isArray","Array","isArray","_i","_getIterator3","_ref","length","next","done","value","key","bind","detectIE","window","ua","navigator","userAgent","msie","indexOf","parseInt","substring","rv","edge","detectChrome","isChromium","chrome","winNav","vendorName","vendor","isOpera","isIEedge","match","ScriptPath","pathParts","Error","e","stackLines","stack","split","callerIndex","Number","this","fullPath","location","origin","pathname","path","host","x","hostname","file","_getIterator2","_getOwnPropertyNames","String","includes","search","start","searchElement","fromIndex","TypeError","len","k","Math","max","abs","y","isNaN","detect_iphone","test","MSStream","XHRWorker","url","ready","scope","oReq","XMLHttpRequest","addEventListener","blob","Blob","responseText","URL","createObjectURL","worker","Worker","open","send","_stringify","_stringify2","_getPrototypeOf","_getPrototypeOf2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_utils","_defaults","_api","__SCRIPT_PATH__","WebWorker","_worker","_this","__proto__","__PSP_WORKER__","_start_embedded","slice","_start_same_origin","_start_cross_origin","msg","transferable","args","ArrayBuffer","postMessage","terminate","undefined","ab","byteLength","console","log","warn","w","_handle","cmd","data","__PSP_WASM__","_detect_transferable","dir","WebAssembly","_start_cross_origin_asmjs","_start_cross_origin_wasm","_this2","wasmXHR","responseType","onload","response","WebSocketWorker","_worker2","_this3","_ws","WebSocket","onopen","id","onmessage","JSON","parse","close","TYPE_AGGREGATES","TYPE_FILTERS","AGGREGATE_DEFAULTS","FILTER_DEFAULTS","SORT_ORDERS","require","NUMBER_AGGREGATES","STRING_AGGREGATES","BOOLEAN_AGGREGATES","BOOLEAN_FILTERS","string","float","integer","boolean","date","NUMBER_FILTERS","STRING_FILTERS","DATE_FILTERS","COLUMN_SEPARATOR_STRING","subscribe","method","resolve","arguments","reject","_name","post","async_queue","_promise2","view","table_name","config","_config","random","view_name","table","options","computed_table","computed","original","column","func","toString","proxy_table","initialized","msg_id","handlers","messages","_promise","to_json","to_columns","to_csv","schema","num_columns","num_rows","expand_to_depth","collapse_to_depth","get_row_expanded","expand","collapse","delete","on_update","on_delete","add_computed","column_metadata","computed_schema","size","columns","remove","update","execute","f","keep_alive","push","_initialized","event","document","createEvent","initEvent","dispatchEvent","handler","error"],"mappings":"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","file":"perspective.cjs.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getIterator2 = __webpack_require__(8);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _getOwnPropertyNames = __webpack_require__(9);\n\nvar _getOwnPropertyNames2 = _interopRequireDefault(_getOwnPropertyNames);\n\nexports.bindall = bindall;\nexports.detectIE = detectIE;\nexports.detectChrome = detectChrome;\nexports.ScriptPath = ScriptPath;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n/**\n * Bind all methods in a class to the class instance.  It is sad that this is\n * necessary.\n *\n * @export\n * @param {*} self\n */\nfunction bindall(self) {\n    for (var _iterator = (0, _getOwnPropertyNames2.default)(self.constructor.prototype), _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n        var _ref;\n\n        if (_isArray) {\n            if (_i >= _iterator.length) break;\n            _ref = _iterator[_i++];\n        } else {\n            _i = _iterator.next();\n            if (_i.done) break;\n            _ref = _i.value;\n        }\n\n        var key = _ref;\n\n        var value = self[key];\n        if (key !== \"constructor\" && typeof value === \"function\") {\n            self[key] = value.bind(self);\n        }\n    }\n}\n\n/**\n * Detect Internet Explorer.\n *\n * Returns\n * -------\n * True if the current script is running in Internet Explorer.\n */\nfunction detectIE() {\n    if (typeof window === \"undefined\") return false;\n    var ua = window.navigator.userAgent;\n    var msie = ua.indexOf(\"MSIE \");\n    if (msie > 0) {\n        return parseInt(ua.substring(msie + 5, ua.indexOf(\".\", msie)), 10);\n    }\n    var trident = ua.indexOf(\"Trident/\");\n    if (trident > 0) {\n        var rv = ua.indexOf(\"rv:\");\n        return parseInt(ua.substring(rv + 3, ua.indexOf(\".\", rv)), 10);\n    }\n    var edge = ua.indexOf(\"Edge/\");\n    if (edge > 0) {\n        return parseInt(ua.substring(edge + 5, ua.indexOf(\".\", edge)), 10);\n    }\n    return false;\n}\n\n/**\n * Detect Chrome.\n *\n * Returns\n * -------\n * Detect if the current script is running in Chrome.\n */\nfunction detectChrome() {\n    var isChromium = window.chrome,\n        winNav = window.navigator,\n        vendorName = winNav.vendor,\n        isOpera = winNav.userAgent.indexOf(\"OPR\") > -1,\n        isIEedge = winNav.userAgent.indexOf(\"Edge\") > -1,\n        isIOSChrome = winNav.userAgent.match(\"CriOS\");\n\n    if (isIOSChrome) {\n        return true;\n    } else if (isChromium !== null && typeof isChromium !== \"undefined\" && vendorName === \"Google Inc.\" && isOpera === false && isIEedge === false) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n * An Object for capturing details of the invoking script's origin.\n *\n * Returns\n * -------\n * An instance of a ScriptPath object.  Interesting methods on this object\n * include:\n *     fullPath : The complete path of this script.\n *     path : The path (no host).\n *     host : The host (no path).\n *     file : The file name itself.\n */\nfunction ScriptPath() {\n    var pathParts;\n    try {\n        throw new Error();\n    } catch (e) {\n        var stackLines = e.stack.split(\"\\n\");\n        var callerIndex = 0;\n        for (var i in stackLines) {\n            if (!stackLines[i].match(/http[s]?:\\/\\//)) continue;\n            callerIndex = Number(i);\n            break;\n        }\n        pathParts = stackLines[callerIndex].match(/((http[s]?:\\/\\/.+\\/)([^\\/]+\\.(js|html))).*?:/);\n    }\n\n    this.fullPath = function () {\n        return pathParts ? pathParts[1] : window.location.origin + window.location.pathname;\n    };\n    this.path = function () {\n        return pathParts ? pathParts[2] : window.location.pathname;\n    };\n    this.host = function () {\n        var x = this.path().match(/.+?\\/\\/.+?\\//);\n        return x ? x[0] : window.location.hostname;\n    };\n    this.file = function () {\n        return pathParts ? pathParts[3] : \"\";\n    };\n}\n\nif (!String.prototype.includes) {\n    String.prototype.includes = function (search, start) {\n        if (typeof start !== \"number\") {\n            start = 0;\n        }\n\n        if (start + search.length > this.length) {\n            return false;\n        } else {\n            return this.indexOf(search, start) !== -1;\n        }\n    };\n}\n\n// from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\nif (!Array.prototype.includes) {\n    Object.defineProperty(Array.prototype, \"includes\", {\n        value: function value(searchElement, fromIndex) {\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            // 1. Let O be ? ToObject(this value).\n            var o = Object(this);\n\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n\n            // 3. If len is 0, return false.\n            if (len === 0) {\n                return false;\n            }\n\n            // 4. Let n be ? ToInteger(fromIndex).\n            //    (If fromIndex is undefined, this step produces the value 0.)\n            var n = fromIndex | 0;\n\n            // 5. If n ≥ 0, then\n            //  a. Let k be n.\n            // 6. Else n < 0,\n            //  a. Let k be len + n.\n            //  b. If k < 0, let k be 0.\n            var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n            function sameValueZero(x, y) {\n                return x === y || typeof x === \"number\" && typeof y === \"number\" && isNaN(x) && isNaN(y);\n            }\n\n            // 7. Repeat, while k < len\n            while (k < len) {\n                // a. Let elementK be the result of ? Get(O, ! ToString(k)).\n                // b. If SameValueZero(searchElement, elementK) is true, return true.\n                if (sameValueZero(o[k], searchElement)) {\n                    return true;\n                }\n                // c. Increase k by 1.\n                k++;\n            }\n\n            // 8. Return false\n            return false;\n        }\n    });\n}\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _stringify = __webpack_require__(2);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _getPrototypeOf = __webpack_require__(3);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(4);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(5);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(6);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(7);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _utils = __webpack_require__(0);\n\nvar _defaults = __webpack_require__(10);\n\nvar _api = __webpack_require__(11);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/******************************************************************************\r\n *\r\n * Utilities\r\n *\r\n */\n\nvar __SCRIPT_PATH__ = new _utils.ScriptPath();\n\n// https://github.com/kripken/emscripten/issues/6042\n/******************************************************************************\r\n *\r\n * Copyright (c) 2017, the Perspective Authors.\r\n *\r\n * This file is part of the Perspective library, distributed under the terms of\r\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\r\n *\r\n */\n\nfunction detect_iphone() {\n    return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream\n    );\n}\n\nfunction XHRWorker(url, ready, scope) {\n    var oReq = new XMLHttpRequest();\n    oReq.addEventListener(\"load\", function () {\n        var blob = new Blob([this.responseText]);\n        var obj = window.URL.createObjectURL(blob);\n        var worker = new Worker(obj);\n        if (ready) {\n            ready.call(scope, worker);\n        }\n    }, oReq);\n    oReq.open(\"get\", url, true);\n    oReq.send();\n}\n\nvar WebWorker = function (_worker) {\n    (0, _inherits3.default)(WebWorker, _worker);\n\n    function WebWorker() {\n        (0, _classCallCheck3.default)(this, WebWorker);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (WebWorker.__proto__ || (0, _getPrototypeOf2.default)(WebWorker)).call(this));\n\n        if (window.__PSP_WORKER__) {\n            _this._start_embedded();\n        } else if (window.location.origin === __SCRIPT_PATH__.host().slice(0, window.location.origin.length)) {\n            _this._start_same_origin();\n        } else {\n            _this._start_cross_origin();\n        }\n        return _this;\n    }\n\n    (0, _createClass3.default)(WebWorker, [{\n        key: \"send\",\n        value: function send(msg) {\n            if (this._worker.transferable && msg.args && msg.args[0] instanceof ArrayBuffer) {\n                this._worker.postMessage(msg, msg.args);\n            } else {\n                this._worker.postMessage(msg);\n            }\n        }\n    }, {\n        key: \"terminate\",\n        value: function terminate() {\n            this._worker.terminate();\n            this._worker = undefined;\n        }\n    }, {\n        key: \"_detect_transferable\",\n        value: function _detect_transferable() {\n            var ab = new ArrayBuffer(1);\n            this._worker.postMessage(ab, [ab]);\n            this._worker.transferable = ab.byteLength === 0;\n            if (!this._worker.transferable) {\n                console.warn(\"Transferable support not detected\");\n            } else {\n                console.log(\"Transferable support detected\");\n            }\n        }\n    }, {\n        key: \"_start_embedded\",\n        value: function _start_embedded() {\n            console.log(\"Running PSP in embedded mode\");\n            var w = new window.__PSP_WORKER__();\n            for (var key in this._worker) {\n                w[key] = this._worker[key];\n            }\n            this._worker = w;\n            this._worker.addEventListener(\"message\", this._handle.bind(this));\n            this._worker.postMessage({ cmd: \"init\", data: window.__PSP_WASM__, path: __SCRIPT_PATH__.path() });\n            this._detect_transferable();\n        }\n    }, {\n        key: \"_start_cross_origin\",\n        value: function _start_cross_origin() {\n            var dir = typeof WebAssembly === \"undefined\" ? \"asmjs\" : \"async\";\n            XHRWorker(__SCRIPT_PATH__.path() + \"perspective.worker.\" + dir + \".js\", function (worker) {\n                for (var key in this._worker) {\n                    worker[key] = this._worker[key];\n                }\n                this._worker.postMessage = worker.postMessage.bind(worker);\n                this._worker.terminate = worker.terminate.bind(worker);\n                this._worker = worker;\n                this._detect_transferable();\n                this._worker.addEventListener(\"message\", this._handle.bind(this));\n                if (typeof WebAssembly === \"undefined\") {\n                    this._start_cross_origin_asmjs();\n                } else {\n                    this._start_cross_origin_wasm();\n                }\n            }, this);\n        }\n    }, {\n        key: \"_start_cross_origin_asmjs\",\n        value: function _start_cross_origin_asmjs() {\n            this._worker.postMessage({\n                cmd: \"init\",\n                path: __SCRIPT_PATH__.path()\n            });\n        }\n    }, {\n        key: \"_start_cross_origin_wasm\",\n        value: function _start_cross_origin_wasm() {\n            var _this2 = this;\n\n            var wasmXHR = new XMLHttpRequest();\n            wasmXHR.open(\"GET\", __SCRIPT_PATH__.path() + \"psp.async.wasm\", true);\n            wasmXHR.responseType = \"arraybuffer\";\n            wasmXHR.onload = function () {\n                var msg = {\n                    cmd: \"init\",\n                    data: wasmXHR.response,\n                    path: __SCRIPT_PATH__.path()\n                };\n                if (_this2._worker.transferable) {\n                    _this2._worker.postMessage(msg, [wasmXHR.response]);\n                } else {\n                    _this2._worker.postMessage(msg);\n                }\n            };\n            wasmXHR.send(null);\n        }\n    }, {\n        key: \"_start_same_origin\",\n        value: function _start_same_origin() {\n            var dir = typeof WebAssembly === \"undefined\" || detect_iphone() ? \"asmjs\" : \"async\";\n            var w = new Worker(__SCRIPT_PATH__.path() + \"perspective.worker.\" + dir + \".js\");\n            for (var key in this._worker) {\n                w[key] = this._worker[key];\n            }\n            this._worker = w;\n            this._worker.addEventListener(\"message\", this._handle.bind(this));\n            this._worker.postMessage({ cmd: \"init\", path: __SCRIPT_PATH__.path() });\n            this._detect_transferable();\n        }\n    }]);\n    return WebWorker;\n}(_api.worker);\n\nvar WebSocketWorker = function (_worker2) {\n    (0, _inherits3.default)(WebSocketWorker, _worker2);\n\n    function WebSocketWorker(url) {\n        (0, _classCallCheck3.default)(this, WebSocketWorker);\n\n        var _this3 = (0, _possibleConstructorReturn3.default)(this, (WebSocketWorker.__proto__ || (0, _getPrototypeOf2.default)(WebSocketWorker)).call(this));\n\n        _this3._ws = new WebSocket(url);\n        _this3._ws.onopen = function () {\n            _this3.send({ id: -1, cmd: \"init\" });\n        };\n        _this3._ws.onmessage = function (msg) {\n            _this3._handle({ data: JSON.parse(msg.data) });\n        };\n        return _this3;\n    }\n\n    (0, _createClass3.default)(WebSocketWorker, [{\n        key: \"send\",\n        value: function send(msg) {\n            this._ws.send((0, _stringify2.default)(msg));\n        }\n    }, {\n        key: \"terminate\",\n        value: function terminate() {\n            this._ws.close();\n        }\n    }]);\n    return WebSocketWorker;\n}(_api.worker);\n\nexports.default = {\n    worker: function worker(url) {\n        if (url) {\n            return new WebSocketWorker(url);\n        } else {\n            return new WebWorker();\n        }\n    },\n\n    TYPE_AGGREGATES: _defaults.TYPE_AGGREGATES,\n\n    TYPE_FILTERS: _defaults.TYPE_FILTERS,\n\n    AGGREGATE_DEFAULTS: _defaults.AGGREGATE_DEFAULTS,\n\n    FILTER_DEFAULTS: _defaults.FILTER_DEFAULTS,\n\n    SORT_ORDERS: _defaults.SORT_ORDERS\n};\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/core-js/object/get-prototype-of\");\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/helpers/classCallCheck\");\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/helpers/createClass\");\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/helpers/inherits\");\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/core-js/object/get-own-property-names\");\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nvar NUMBER_AGGREGATES = [\"any\", \"avg\", \"count\", \"distinct count\", \"dominant\", \"first by index\", \"last by index\", \"last\", \"high\", \"low\", \"mean\", \"mean by count\", \"median\", \"pct sum parent\", \"pct sum grand total\", \"sum\", \"sum abs\", \"sum not null\", \"unique\"];\n\nvar STRING_AGGREGATES = [\"any\", \"count\", \"distinct count\", \"distinct leaf\", \"dominant\", \"first by index\", \"last by index\", \"last\", \"mean by count\", \"unique\"];\n\nvar BOOLEAN_AGGREGATES = [\"any\", \"count\", \"distinct count\", \"distinct leaf\", \"dominant\", \"first by index\", \"last by index\", \"last\", \"mean by count\", \"unique\", \"and\", \"or\"];\n\nvar SORT_ORDERS = exports.SORT_ORDERS = [\"asc\", \"desc\", \"none\", \"asc abs\", \"desc abs\"];\n\nvar TYPE_AGGREGATES = exports.TYPE_AGGREGATES = {\n    string: STRING_AGGREGATES,\n    float: NUMBER_AGGREGATES,\n    integer: NUMBER_AGGREGATES,\n    boolean: BOOLEAN_AGGREGATES,\n    date: STRING_AGGREGATES\n};\n\nvar AGGREGATE_DEFAULTS = exports.AGGREGATE_DEFAULTS = {\n    string: \"distinct count\",\n    float: \"sum\",\n    integer: \"sum\",\n    boolean: \"distinct count\",\n    date: \"distinct count\"\n};\n\nvar BOOLEAN_FILTERS = [\"&\", \"|\", \"==\", \"!=\", \"or\", \"and\"];\n\nvar NUMBER_FILTERS = [\"<\", \">\", \"==\", \"<=\", \">=\", \"!=\", \"is nan\", \"is not nan\"];\n\nvar STRING_FILTERS = [\"==\", \"contains\", \"!=\", \"in\", \"begins with\", \"ends with\"];\n\nvar DATE_FILTERS = [\"<\", \">\", \"==\", \"<=\", \">=\", \"!=\"];\n\nvar COLUMN_SEPARATOR_STRING = exports.COLUMN_SEPARATOR_STRING = \"|\";\n\nvar TYPE_FILTERS = exports.TYPE_FILTERS = {\n    string: STRING_FILTERS,\n    float: NUMBER_FILTERS,\n    integer: NUMBER_FILTERS,\n    boolean: BOOLEAN_FILTERS,\n    date: DATE_FILTERS\n};\n\nvar FILTER_DEFAULTS = exports.FILTER_DEFAULTS = {\n    string: \"==\",\n    float: \"==\",\n    integer: \"==\",\n    boolean: \"==\",\n    date: \"==\"\n};\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _promise = __webpack_require__(12);\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nexports.worker = worker;\n\nvar _utils = __webpack_require__(0);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction subscribe(method, cmd) {\n    return function () {\n        var resolve = arguments[arguments.length - 1];\n        var reject = function reject() {};\n        var args = Array.prototype.slice.call(arguments, 0, arguments.length - 1);\n        var msg = {\n            cmd: cmd || \"view_method\",\n            name: this._name,\n            method: method,\n            args: args,\n            subscribe: true\n        };\n        this._worker.post(msg, resolve, reject, true);\n    };\n} /******************************************************************************\n   *\n   * Copyright (c) 2017, the Perspective Authors.\n   *\n   * This file is part of the Perspective library, distributed under the terms of\n   * the Apache License 2.0.  The full license can be found in the LICENSE file.\n   *\n   */\n\nfunction async_queue(method, cmd) {\n    return function () {\n        var args = Array.prototype.slice.call(arguments, 0, arguments.length);\n        return new _promise2.default(function (resolve, reject) {\n            var msg = {\n                cmd: cmd || \"view_method\",\n                name: this._name,\n                method: method,\n                args: args,\n                subscribe: false\n            };\n            this._worker.post(msg, resolve, reject);\n        }.bind(this));\n    };\n}\n\nfunction view(worker, table_name, config) {\n    this._worker = worker;\n    this._config = config;\n    this._name = Math.random() + \"\";\n    var msg = {\n        cmd: \"view\",\n        view_name: this._name,\n        table_name: table_name,\n        config: config\n    };\n    this._worker.post(msg);\n    (0, _utils.bindall)(this);\n}\n\nview.prototype.to_json = async_queue(\"to_json\");\n\nview.prototype.to_columns = async_queue(\"to_columns\");\n\nview.prototype.to_csv = async_queue(\"to_csv\");\n\nview.prototype.schema = async_queue(\"schema\");\n\nview.prototype.num_columns = async_queue(\"num_columns\");\n\nview.prototype.num_rows = async_queue(\"num_rows\");\n\nview.prototype.expand_to_depth = async_queue(\"expand_to_depth\");\n\nview.prototype.collapse_to_depth = async_queue(\"collapse_to_depth\");\n\nview.prototype.get_row_expanded = async_queue(\"get_row_expanded\");\n\nview.prototype.expand = async_queue(\"expand\");\n\nview.prototype.collapse = async_queue(\"collapse\");\n\nview.prototype.delete = async_queue(\"delete\");\n\nview.prototype.on_update = subscribe(\"on_update\", \"view_method\", true);\n\nview.prototype.on_delete = subscribe(\"on_delete\", \"view_method\", true);\n\nfunction table(worker, data, options) {\n    this._worker = worker;\n    // Set up msg\n    name = options.name || Math.random() + \"\";\n    var msg = {\n        cmd: \"table\",\n        name: name,\n        args: [data],\n        options: options || {}\n    };\n    this._worker.post(msg);\n    this._name = name;\n\n    (0, _utils.bindall)(this);\n}\n\nfunction computed_table(worker, computed, name) {\n    this._worker = worker;\n    this._name = Math.random() + \"\";\n    var original = name;\n    // serialize functions\n    for (var i = 0; i < computed.length; ++i) {\n        var column = computed[i];\n        var func = column[\"func\"];\n        if (typeof func == \"function\") {\n            column[\"func\"] = func.toString();\n        }\n    }\n    var msg = {\n        cmd: \"add_computed\",\n        original: original,\n        name: this._name,\n        computed: computed\n    };\n    this._worker.post(msg);\n}\n\nfunction proxy_table(worker, name) {\n    this._worker = worker;\n    this._name = name;\n}\n\ncomputed_table.prototype = table.prototype;\nproxy_table.prototype = table.prototype;\n\ntable.prototype.add_computed = function (computed) {\n    return new computed_table(this._worker, computed, this._name);\n};\n\ntable.prototype.view = function (config) {\n    return new view(this._worker, this._name, config);\n};\n\ntable.prototype.schema = async_queue(\"schema\", \"table_method\");\n\ntable.prototype.column_metadata = async_queue(\"column_metadata\", \"table_method\");\n\ntable.prototype.computed_schema = async_queue(\"computed_schema\", \"table_method\");\n\ntable.prototype.size = async_queue(\"size\", \"table_method\");\n\ntable.prototype.columns = async_queue(\"columns\", \"table_method\");\n\ntable.prototype.delete = async_queue(\"delete\", \"table_method\");\n\ntable.prototype.on_delete = subscribe(\"on_delete\", \"table_method\", true);\n\ntable.prototype.remove = async_queue(\"remove\", \"table_method\");\n\ntable.prototype.update = function (data) {\n    var _this = this;\n\n    return new _promise2.default(function (resolve, reject) {\n        var msg = {\n            name: _this._name,\n            cmd: \"table_method\",\n            method: \"update\",\n            args: [data]\n        };\n        _this._worker.post(msg, resolve, reject, false);\n    });\n};\n\ntable.prototype.execute = function (f) {\n    var msg = {\n        cmd: \"table_execute\",\n        name: this._name,\n        f: f.toString()\n    };\n    this._worker.post(msg);\n};\n\nfunction worker() {\n    this._worker = {\n        initialized: { value: false },\n        transferable: false,\n        msg_id: 0,\n        handlers: {},\n        messages: []\n    };\n    (0, _utils.bindall)(this);\n}\n\nworker.prototype.post = function (msg, resolve, reject) {\n    var _this2 = this;\n\n    var keep_alive = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n    if (resolve) {\n        this._worker.handlers[++this._worker.msg_id] = { resolve: resolve, reject: reject, keep_alive: keep_alive };\n    }\n    msg.id = this._worker.msg_id;\n    if (this._worker.initialized.value) {\n        this.send(msg);\n    } else {\n        this._worker.messages.push(function () {\n            return _this2.send(msg);\n        });\n    }\n};\n\nworker.prototype.send = function () {\n    throw new Error(\"post() not implemented\");\n};\n\nworker.prototype.open = function (name) {\n    return new proxy_table(this, name);\n};\n\nvar _initialized = false;\n\nworker.prototype._handle = function (e) {\n    if (!this._worker.initialized.value) {\n        if (!_initialized) {\n            var event = document.createEvent(\"Event\");\n            event.initEvent(\"perspective-ready\", false, true);\n            window.dispatchEvent(event);\n            _initialized = true;\n        }\n        for (var m in this._worker.messages) {\n            if (this._worker.messages.hasOwnProperty(m)) {\n                this._worker.messages[m]();\n            }\n        }\n        this._worker.initialized.value = true;\n        this._worker.messages = [];\n    }\n    if (e.data.id) {\n        var handler = this._worker.handlers[e.data.id];\n        if (handler) {\n            if (e.data.error) {\n                handler.reject(e.data.error);\n            } else {\n                handler.resolve(e.data.data);\n            }\n            if (!handler.keep_alive) {\n                delete this._worker.handlers[e.data.id];\n            }\n        }\n    }\n};\n\nworker.prototype.table = function (data, options) {\n    return new table(this, data, options || {});\n};\n\nworker.prototype.terminate = function () {\n    this._worker.terminate();\n    this._worker = undefined;\n};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"babel-runtime/core-js/promise\");\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// perspective.cjs.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 79e024b3e3fa01d7859e","/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n/**\n * Bind all methods in a class to the class instance.  It is sad that this is\n * necessary.\n *\n * @export\n * @param {*} self\n */\nexport function bindall(self) {\n    for (const key of Object.getOwnPropertyNames(self.constructor.prototype)) {\n        const value = self[key];\n        if (key !== \"constructor\" && typeof value === \"function\") {\n            self[key] = value.bind(self);\n        }\n    }\n}\n\n/**\n * Detect Internet Explorer.\n *\n * Returns\n * -------\n * True if the current script is running in Internet Explorer.\n */\nexport function detectIE() {\n    if (typeof window === \"undefined\") return false;\n    var ua = window.navigator.userAgent;\n    var msie = ua.indexOf(\"MSIE \");\n    if (msie > 0) {\n        return parseInt(ua.substring(msie + 5, ua.indexOf(\".\", msie)), 10);\n    }\n    var trident = ua.indexOf(\"Trident/\");\n    if (trident > 0) {\n        var rv = ua.indexOf(\"rv:\");\n        return parseInt(ua.substring(rv + 3, ua.indexOf(\".\", rv)), 10);\n    }\n    var edge = ua.indexOf(\"Edge/\");\n    if (edge > 0) {\n        return parseInt(ua.substring(edge + 5, ua.indexOf(\".\", edge)), 10);\n    }\n    return false;\n}\n\n/**\n * Detect Chrome.\n *\n * Returns\n * -------\n * Detect if the current script is running in Chrome.\n */\nexport function detectChrome() {\n    var isChromium = window.chrome,\n        winNav = window.navigator,\n        vendorName = winNav.vendor,\n        isOpera = winNav.userAgent.indexOf(\"OPR\") > -1,\n        isIEedge = winNav.userAgent.indexOf(\"Edge\") > -1,\n        isIOSChrome = winNav.userAgent.match(\"CriOS\");\n\n    if (isIOSChrome) {\n        return true;\n    } else if (isChromium !== null && typeof isChromium !== \"undefined\" && vendorName === \"Google Inc.\" && isOpera === false && isIEedge === false) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n * An Object for capturing details of the invoking script's origin.\n *\n * Returns\n * -------\n * An instance of a ScriptPath object.  Interesting methods on this object\n * include:\n *     fullPath : The complete path of this script.\n *     path : The path (no host).\n *     host : The host (no path).\n *     file : The file name itself.\n */\nexport function ScriptPath() {\n    var pathParts;\n    try {\n        throw new Error();\n    } catch (e) {\n        var stackLines = e.stack.split(\"\\n\");\n        var callerIndex = 0;\n        for (var i in stackLines) {\n            if (!stackLines[i].match(/http[s]?:\\/\\//)) continue;\n            callerIndex = Number(i);\n            break;\n        }\n        pathParts = stackLines[callerIndex].match(/((http[s]?:\\/\\/.+\\/)([^\\/]+\\.(js|html))).*?:/);\n    }\n\n    this.fullPath = function() {\n        return pathParts ? pathParts[1] : window.location.origin + window.location.pathname;\n    };\n    this.path = function() {\n        return pathParts ? pathParts[2] : window.location.pathname;\n    };\n    this.host = function() {\n        let x = this.path().match(/.+?\\/\\/.+?\\//);\n        return x ? x[0] : window.location.hostname;\n    };\n    this.file = function() {\n        return pathParts ? pathParts[3] : \"\";\n    };\n}\n\nif (!String.prototype.includes) {\n    String.prototype.includes = function(search, start) {\n        if (typeof start !== \"number\") {\n            start = 0;\n        }\n\n        if (start + search.length > this.length) {\n            return false;\n        } else {\n            return this.indexOf(search, start) !== -1;\n        }\n    };\n}\n\n// from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\nif (!Array.prototype.includes) {\n    Object.defineProperty(Array.prototype, \"includes\", {\n        value: function(searchElement, fromIndex) {\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            // 1. Let O be ? ToObject(this value).\n            var o = Object(this);\n\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n\n            // 3. If len is 0, return false.\n            if (len === 0) {\n                return false;\n            }\n\n            // 4. Let n be ? ToInteger(fromIndex).\n            //    (If fromIndex is undefined, this step produces the value 0.)\n            var n = fromIndex | 0;\n\n            // 5. If n ≥ 0, then\n            //  a. Let k be n.\n            // 6. Else n < 0,\n            //  a. Let k be len + n.\n            //  b. If k < 0, let k be 0.\n            var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n            function sameValueZero(x, y) {\n                return x === y || (typeof x === \"number\" && typeof y === \"number\" && isNaN(x) && isNaN(y));\n            }\n\n            // 7. Repeat, while k < len\n            while (k < len) {\n                // a. Let elementK be the result of ? Get(O, ! ToString(k)).\n                // b. If SameValueZero(searchElement, elementK) is true, return true.\n                if (sameValueZero(o[k], searchElement)) {\n                    return true;\n                }\n                // c. Increase k by 1.\n                k++;\n            }\n\n            // 8. Return false\n            return false;\n        }\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils.js","/******************************************************************************\r\n *\r\n * Copyright (c) 2017, the Perspective Authors.\r\n *\r\n * This file is part of the Perspective library, distributed under the terms of\r\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\r\n *\r\n */\r\n\r\nimport {ScriptPath} from \"./utils.js\";\r\n\r\nimport {TYPE_AGGREGATES, AGGREGATE_DEFAULTS, TYPE_FILTERS, FILTER_DEFAULTS, SORT_ORDERS} from \"./defaults.js\";\r\n\r\nimport {worker} from \"./api.js\";\r\n\r\n/******************************************************************************\r\n *\r\n * Utilities\r\n *\r\n */\r\n\r\nvar __SCRIPT_PATH__ = new ScriptPath();\r\n\r\n// https://github.com/kripken/emscripten/issues/6042\r\nfunction detect_iphone() {\r\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n}\r\n\r\nfunction XHRWorker(url, ready, scope) {\r\n    var oReq = new XMLHttpRequest();\r\n    oReq.addEventListener(\r\n        \"load\",\r\n        function() {\r\n            var blob = new Blob([this.responseText]);\r\n            var obj = window.URL.createObjectURL(blob);\r\n            var worker = new Worker(obj);\r\n            if (ready) {\r\n                ready.call(scope, worker);\r\n            }\r\n        },\r\n        oReq\r\n    );\r\n    oReq.open(\"get\", url, true);\r\n    oReq.send();\r\n}\r\n\r\nclass WebWorker extends worker {\r\n    constructor() {\r\n        super();\r\n        if (window.__PSP_WORKER__) {\r\n            this._start_embedded();\r\n        } else if (window.location.origin === __SCRIPT_PATH__.host().slice(0, window.location.origin.length)) {\r\n            this._start_same_origin();\r\n        } else {\r\n            this._start_cross_origin();\r\n        }\r\n    }\r\n\r\n    send(msg) {\r\n        if (this._worker.transferable && msg.args && msg.args[0] instanceof ArrayBuffer) {\r\n            this._worker.postMessage(msg, msg.args);\r\n        } else {\r\n            this._worker.postMessage(msg);\r\n        }\r\n    }\r\n\r\n    terminate() {\r\n        this._worker.terminate();\r\n        this._worker = undefined;\r\n    }\r\n\r\n    _detect_transferable() {\r\n        var ab = new ArrayBuffer(1);\r\n        this._worker.postMessage(ab, [ab]);\r\n        this._worker.transferable = ab.byteLength === 0;\r\n        if (!this._worker.transferable) {\r\n            console.warn(\"Transferable support not detected\");\r\n        } else {\r\n            console.log(\"Transferable support detected\");\r\n        }\r\n    }\r\n\r\n    _start_embedded() {\r\n        console.log(\"Running PSP in embedded mode\");\r\n        var w = new window.__PSP_WORKER__();\r\n        for (var key in this._worker) {\r\n            w[key] = this._worker[key];\r\n        }\r\n        this._worker = w;\r\n        this._worker.addEventListener(\"message\", this._handle.bind(this));\r\n        this._worker.postMessage({cmd: \"init\", data: window.__PSP_WASM__, path: __SCRIPT_PATH__.path()});\r\n        this._detect_transferable();\r\n    }\r\n\r\n    _start_cross_origin() {\r\n        var dir = typeof WebAssembly === \"undefined\" ? \"asmjs\" : \"async\";\r\n        XHRWorker(\r\n            __SCRIPT_PATH__.path() + \"perspective.worker.\" + dir + \".js\",\r\n            function(worker) {\r\n                for (var key in this._worker) {\r\n                    worker[key] = this._worker[key];\r\n                }\r\n                this._worker.postMessage = worker.postMessage.bind(worker);\r\n                this._worker.terminate = worker.terminate.bind(worker);\r\n                this._worker = worker;\r\n                this._detect_transferable();\r\n                this._worker.addEventListener(\"message\", this._handle.bind(this));\r\n                if (typeof WebAssembly === \"undefined\") {\r\n                    this._start_cross_origin_asmjs();\r\n                } else {\r\n                    this._start_cross_origin_wasm();\r\n                }\r\n            },\r\n            this\r\n        );\r\n    }\r\n\r\n    _start_cross_origin_asmjs() {\r\n        this._worker.postMessage({\r\n            cmd: \"init\",\r\n            path: __SCRIPT_PATH__.path()\r\n        });\r\n    }\r\n\r\n    _start_cross_origin_wasm() {\r\n        var wasmXHR = new XMLHttpRequest();\r\n        wasmXHR.open(\"GET\", __SCRIPT_PATH__.path() + \"psp.async.wasm\", true);\r\n        wasmXHR.responseType = \"arraybuffer\";\r\n        wasmXHR.onload = () => {\r\n            let msg = {\r\n                cmd: \"init\",\r\n                data: wasmXHR.response,\r\n                path: __SCRIPT_PATH__.path()\r\n            };\r\n            if (this._worker.transferable) {\r\n                this._worker.postMessage(msg, [wasmXHR.response]);\r\n            } else {\r\n                this._worker.postMessage(msg);\r\n            }\r\n        };\r\n        wasmXHR.send(null);\r\n    }\r\n\r\n    _start_same_origin() {\r\n        var dir = typeof WebAssembly === \"undefined\" || detect_iphone() ? \"asmjs\" : \"async\";\r\n        var w = new Worker(__SCRIPT_PATH__.path() + \"perspective.worker.\" + dir + \".js\");\r\n        for (var key in this._worker) {\r\n            w[key] = this._worker[key];\r\n        }\r\n        this._worker = w;\r\n        this._worker.addEventListener(\"message\", this._handle.bind(this));\r\n        this._worker.postMessage({cmd: \"init\", path: __SCRIPT_PATH__.path()});\r\n        this._detect_transferable();\r\n    }\r\n}\r\n\r\nclass WebSocketWorker extends worker {\r\n    constructor(url) {\r\n        super();\r\n        this._ws = new WebSocket(url);\r\n        this._ws.onopen = () => {\r\n            this.send({id: -1, cmd: \"init\"});\r\n        };\r\n        this._ws.onmessage = msg => {\r\n            this._handle({data: JSON.parse(msg.data)});\r\n        };\r\n    }\r\n\r\n    send(msg) {\r\n        this._ws.send(JSON.stringify(msg));\r\n    }\r\n\r\n    terminate() {\r\n        this._ws.close();\r\n    }\r\n}\r\n\r\nexport default {\r\n    worker: function(url) {\r\n        if (url) {\r\n            return new WebSocketWorker(url);\r\n        } else {\r\n            return new WebWorker();\r\n        }\r\n    },\r\n\r\n    TYPE_AGGREGATES: TYPE_AGGREGATES,\r\n\r\n    TYPE_FILTERS: TYPE_FILTERS,\r\n\r\n    AGGREGATE_DEFAULTS: AGGREGATE_DEFAULTS,\r\n\r\n    FILTER_DEFAULTS: FILTER_DEFAULTS,\r\n\r\n    SORT_ORDERS: SORT_ORDERS\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/perspective.parallel.js","module.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/json/stringify\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/object/get-prototype-of\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/object/get-prototype-of\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/classCallCheck\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/classCallCheck\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/createClass\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/createClass\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/possibleConstructorReturn\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/inherits\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/inherits\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/get-iterator\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/object/get-own-property-names\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/object/get-own-property-names\"\n// module id = 9\n// module chunks = 0","/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nconst NUMBER_AGGREGATES = [\n    \"any\",\n    \"avg\",\n    \"count\",\n    \"distinct count\",\n    \"dominant\",\n    \"first by index\",\n    \"last by index\",\n    \"last\",\n    \"high\",\n    \"low\",\n    \"mean\",\n    \"mean by count\",\n    \"median\",\n    \"pct sum parent\",\n    \"pct sum grand total\",\n    \"sum\",\n    \"sum abs\",\n    \"sum not null\",\n    \"unique\"\n];\n\nconst STRING_AGGREGATES = [\"any\", \"count\", \"distinct count\", \"distinct leaf\", \"dominant\", \"first by index\", \"last by index\", \"last\", \"mean by count\", \"unique\"];\n\nconst BOOLEAN_AGGREGATES = [\"any\", \"count\", \"distinct count\", \"distinct leaf\", \"dominant\", \"first by index\", \"last by index\", \"last\", \"mean by count\", \"unique\", \"and\", \"or\"];\n\nexport const SORT_ORDERS = [\"asc\", \"desc\", \"none\", \"asc abs\", \"desc abs\"];\n\nexport const TYPE_AGGREGATES = {\n    string: STRING_AGGREGATES,\n    float: NUMBER_AGGREGATES,\n    integer: NUMBER_AGGREGATES,\n    boolean: BOOLEAN_AGGREGATES,\n    date: STRING_AGGREGATES\n};\n\nexport const AGGREGATE_DEFAULTS = {\n    string: \"distinct count\",\n    float: \"sum\",\n    integer: \"sum\",\n    boolean: \"distinct count\",\n    date: \"distinct count\"\n};\n\nconst BOOLEAN_FILTERS = [\"&\", \"|\", \"==\", \"!=\", \"or\", \"and\"];\n\nconst NUMBER_FILTERS = [\"<\", \">\", \"==\", \"<=\", \">=\", \"!=\", \"is nan\", \"is not nan\"];\n\nconst STRING_FILTERS = [\"==\", \"contains\", \"!=\", \"in\", \"begins with\", \"ends with\"];\n\nconst DATE_FILTERS = [\"<\", \">\", \"==\", \"<=\", \">=\", \"!=\"];\n\nexport const COLUMN_SEPARATOR_STRING = \"|\";\n\nexport const TYPE_FILTERS = {\n    string: STRING_FILTERS,\n    float: NUMBER_FILTERS,\n    integer: NUMBER_FILTERS,\n    boolean: BOOLEAN_FILTERS,\n    date: DATE_FILTERS\n};\n\nexport const FILTER_DEFAULTS = {\n    string: \"==\",\n    float: \"==\",\n    integer: \"==\",\n    boolean: \"==\",\n    date: \"==\"\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/defaults.js","/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport {bindall} from \"./utils.js\";\n\nfunction subscribe(method, cmd) {\n    return function() {\n        let resolve = arguments[arguments.length - 1];\n        let reject = () => {};\n        let args = Array.prototype.slice.call(arguments, 0, arguments.length - 1);\n        let msg = {\n            cmd: cmd || \"view_method\",\n            name: this._name,\n            method: method,\n            args: args,\n            subscribe: true\n        };\n        this._worker.post(msg, resolve, reject, true);\n    };\n}\n\nfunction async_queue(method, cmd) {\n    return function() {\n        var args = Array.prototype.slice.call(arguments, 0, arguments.length);\n        return new Promise(\n            function(resolve, reject) {\n                var msg = {\n                    cmd: cmd || \"view_method\",\n                    name: this._name,\n                    method: method,\n                    args: args,\n                    subscribe: false\n                };\n                this._worker.post(msg, resolve, reject);\n            }.bind(this)\n        );\n    };\n}\n\nfunction view(worker, table_name, config) {\n    this._worker = worker;\n    this._config = config;\n    this._name = Math.random() + \"\";\n    var msg = {\n        cmd: \"view\",\n        view_name: this._name,\n        table_name: table_name,\n        config: config\n    };\n    this._worker.post(msg);\n    bindall(this);\n}\n\nview.prototype.to_json = async_queue(\"to_json\");\n\nview.prototype.to_columns = async_queue(\"to_columns\");\n\nview.prototype.to_csv = async_queue(\"to_csv\");\n\nview.prototype.schema = async_queue(\"schema\");\n\nview.prototype.num_columns = async_queue(\"num_columns\");\n\nview.prototype.num_rows = async_queue(\"num_rows\");\n\nview.prototype.expand_to_depth = async_queue(\"expand_to_depth\");\n\nview.prototype.collapse_to_depth = async_queue(\"collapse_to_depth\");\n\nview.prototype.get_row_expanded = async_queue(\"get_row_expanded\");\n\nview.prototype.expand = async_queue(\"expand\");\n\nview.prototype.collapse = async_queue(\"collapse\");\n\nview.prototype.delete = async_queue(\"delete\");\n\nview.prototype.on_update = subscribe(\"on_update\", \"view_method\", true);\n\nview.prototype.on_delete = subscribe(\"on_delete\", \"view_method\", true);\n\nfunction table(worker, data, options) {\n    this._worker = worker;\n    // Set up msg\n    name = options.name || Math.random() + \"\";\n    var msg = {\n        cmd: \"table\",\n        name: name,\n        args: [data],\n        options: options || {}\n    };\n    this._worker.post(msg);\n    this._name = name;\n\n    bindall(this);\n}\n\nfunction computed_table(worker, computed, name) {\n    this._worker = worker;\n    this._name = Math.random() + \"\";\n    let original = name;\n    // serialize functions\n    for (let i = 0; i < computed.length; ++i) {\n        let column = computed[i];\n        let func = column[\"func\"];\n        if (typeof func == \"function\") {\n            column[\"func\"] = func.toString();\n        }\n    }\n    var msg = {\n        cmd: \"add_computed\",\n        original: original,\n        name: this._name,\n        computed: computed\n    };\n    this._worker.post(msg);\n}\n\nfunction proxy_table(worker, name) {\n    this._worker = worker;\n    this._name = name;\n}\n\ncomputed_table.prototype = table.prototype;\nproxy_table.prototype = table.prototype;\n\ntable.prototype.add_computed = function(computed) {\n    return new computed_table(this._worker, computed, this._name);\n};\n\ntable.prototype.view = function(config) {\n    return new view(this._worker, this._name, config);\n};\n\ntable.prototype.schema = async_queue(\"schema\", \"table_method\");\n\ntable.prototype.column_metadata = async_queue(\"column_metadata\", \"table_method\");\n\ntable.prototype.computed_schema = async_queue(\"computed_schema\", \"table_method\");\n\ntable.prototype.size = async_queue(\"size\", \"table_method\");\n\ntable.prototype.columns = async_queue(\"columns\", \"table_method\");\n\ntable.prototype.delete = async_queue(\"delete\", \"table_method\");\n\ntable.prototype.on_delete = subscribe(\"on_delete\", \"table_method\", true);\n\ntable.prototype.remove = async_queue(\"remove\", \"table_method\");\n\ntable.prototype.update = function(data) {\n    return new Promise((resolve, reject) => {\n        var msg = {\n            name: this._name,\n            cmd: \"table_method\",\n            method: \"update\",\n            args: [data]\n        };\n        this._worker.post(msg, resolve, reject, false);\n    });\n};\n\ntable.prototype.execute = function(f) {\n    var msg = {\n        cmd: \"table_execute\",\n        name: this._name,\n        f: f.toString()\n    };\n    this._worker.post(msg);\n};\n\nexport function worker() {\n    this._worker = {\n        initialized: {value: false},\n        transferable: false,\n        msg_id: 0,\n        handlers: {},\n        messages: []\n    };\n    bindall(this);\n}\n\nworker.prototype.post = function(msg, resolve, reject, keep_alive = false) {\n    if (resolve) {\n        this._worker.handlers[++this._worker.msg_id] = {resolve, reject, keep_alive};\n    }\n    msg.id = this._worker.msg_id;\n    if (this._worker.initialized.value) {\n        this.send(msg);\n    } else {\n        this._worker.messages.push(() => this.send(msg));\n    }\n};\n\nworker.prototype.send = function() {\n    throw new Error(\"post() not implemented\");\n};\n\nworker.prototype.open = function(name) {\n    return new proxy_table(this, name);\n};\n\nlet _initialized = false;\n\nworker.prototype._handle = function(e) {\n    if (!this._worker.initialized.value) {\n        if (!_initialized) {\n            var event = document.createEvent(\"Event\");\n            event.initEvent(\"perspective-ready\", false, true);\n            window.dispatchEvent(event);\n            _initialized = true;\n        }\n        for (var m in this._worker.messages) {\n            if (this._worker.messages.hasOwnProperty(m)) {\n                this._worker.messages[m]();\n            }\n        }\n        this._worker.initialized.value = true;\n        this._worker.messages = [];\n    }\n    if (e.data.id) {\n        var handler = this._worker.handlers[e.data.id];\n        if (handler) {\n            if (e.data.error) {\n                handler.reject(e.data.error);\n            } else {\n                handler.resolve(e.data.data);\n            }\n            if (!handler.keep_alive) {\n                delete this._worker.handlers[e.data.id];\n            }\n        }\n    }\n};\n\nworker.prototype.table = function(data, options) {\n    return new table(this, data, options || {});\n};\n\nworker.prototype.terminate = function() {\n    this._worker.terminate();\n    this._worker = undefined;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/api.js","module.exports = require(\"babel-runtime/core-js/promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/promise\"\n// module id = 12\n// module chunks = 0"],"sourceRoot":""}